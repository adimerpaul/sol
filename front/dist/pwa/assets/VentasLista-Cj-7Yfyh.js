import{v as be,az as ve,G as ye,g as he,J as _e,x as g,r as Ce,p as Ve,aA as $,aB as xe,j as B,af as h,aC as we,f as b,_ as qe,c as C,o as y,w as s,a as l,a8 as f,a9 as ee,aa as G,b as i,Q as V,e as v,P as w,d as q,t as m,h as j}from"./index-D17d9CED.js";import{Q as T}from"./QSelect-CvCEXiBv.js";import{c as te,Q as S,b as p}from"./QList-DtAzkZzK.js";import{Q as le}from"./QBtnDropdown-DZ9Zwjea.js";import{b as Se,Q as ae}from"./format-C2NjPuPn.js";import{Q as N}from"./QTd-D0V8Af-v.js";import{Q as oe}from"./QTable-ndNxYlyN.js";import{Q as Y}from"./QSpace-CRJFh_fq.js";import{Q as ke}from"./QPage-Mqie5rLH.js";import{C as k}from"./ClosePopup-DI1WlcTZ.js";import{I as U}from"./ImprimirTicket-CSMN7aKQ.js";import{h as M}from"./moment-BLMuvzoS.js";import"./position-engine-DqQ8RByf.js";function L(t,e){return[!0,!1].includes(t)?t:e}const Ue=be({name:"QPagination",props:{...ye,modelValue:{type:Number,required:!0},min:{type:[Number,String],default:1},max:{type:[Number,String],required:!0},maxPages:{type:[Number,String],default:0,validator:t=>(typeof t=="string"?parseInt(t,10):t)>=0},inputStyle:[Array,String,Object],inputClass:[Array,String,Object],size:String,disable:Boolean,input:Boolean,iconPrev:String,iconNext:String,iconFirst:String,iconLast:String,toFn:Function,boundaryLinks:{type:Boolean,default:null},boundaryNumbers:{type:Boolean,default:null},directionLinks:{type:Boolean,default:null},ellipses:{type:Boolean,default:null},ripple:{type:[Boolean,Object],default:null},round:Boolean,rounded:Boolean,flat:Boolean,outline:Boolean,unelevated:Boolean,push:Boolean,glossy:Boolean,color:{type:String,default:"primary"},textColor:String,activeDesign:{type:String,default:"",values:t=>t===""||ve.includes(t)},activeColor:String,activeTextColor:String,gutter:String,padding:{type:String,default:"3px 2px"}},emits:["update:modelValue"],setup(t,{emit:e}){const{proxy:u}=he(),{$q:c}=u,o=_e(t,c),r=g(()=>parseInt(t.min,10)),a=g(()=>parseInt(t.max,10)),P=g(()=>parseInt(t.maxPages,10)),J=g(()=>I.value+" / "+a.value),se=g(()=>L(t.boundaryLinks,t.input)),O=g(()=>L(t.boundaryNumbers,!t.input)),ie=g(()=>L(t.directionLinks,t.input)),H=g(()=>L(t.ellipses,!t.input)),Q=Ce(null),I=g({get:()=>t.modelValue,set:n=>{if(n=parseInt(n,10),t.disable||isNaN(n))return;const d=Se(n,r.value,a.value);t.modelValue!==d&&e("update:modelValue",d)}});Ve(()=>`${r.value}|${a.value}`,()=>{I.value=t.modelValue});const re=g(()=>"q-pagination row no-wrap items-center"+(t.disable===!0?" disabled":"")),z=g(()=>t.gutter in $?`${$[t.gutter]}px`:t.gutter||null),ne=g(()=>z.value!==null?`--q-pagination-gutter-parent:-${z.value};--q-pagination-gutter-child:${z.value}`:null),F=g(()=>{const n=[t.iconFirst||c.iconSet.pagination.first,t.iconPrev||c.iconSet.pagination.prev,t.iconNext||c.iconSet.pagination.next,t.iconLast||c.iconSet.pagination.last];return c.lang.rtl===!0?n.reverse():n}),ue=g(()=>({"aria-disabled":t.disable===!0?"true":"false",role:"navigation"})),K=g(()=>xe(t,"flat")),de=g(()=>({[K.value]:!0,round:t.round,rounded:t.rounded,padding:t.padding,color:t.color,textColor:t.textColor,size:t.size,ripple:t.ripple!==null?t.ripple:!0})),me=g(()=>{const n={[K.value]:!1};return t.activeDesign!==""&&(n[t.activeDesign]=!0),n}),ce=g(()=>({...me.value,color:t.activeColor||t.color,textColor:t.activeTextColor||t.textColor})),R=g(()=>{let n=Math.max(P.value,1+(H.value?2:0)+(O.value?2:0));const d={pgFrom:r.value,pgTo:a.value,ellipsesStart:!1,ellipsesEnd:!1,boundaryStart:!1,boundaryEnd:!1,marginalStyle:{minWidth:`${Math.max(2,String(a.value).length)}em`}};return P.value&&n<a.value-r.value+1&&(n=1+Math.floor(n/2)*2,d.pgFrom=Math.max(r.value,Math.min(a.value-n+1,t.modelValue-Math.floor(n/2))),d.pgTo=Math.min(a.value,d.pgFrom+n-1),O.value&&(d.boundaryStart=!0,d.pgFrom++),H.value&&d.pgFrom>r.value+(O.value?1:0)&&(d.ellipsesStart=!0,d.pgFrom++),O.value&&(d.boundaryEnd=!0,d.pgTo--),H.value&&d.pgTo<a.value-(O.value?1:0)&&(d.ellipsesEnd=!0,d.pgTo--)),d});function W(n){I.value=n}function fe(n){I.value=I.value+n}function X(){I.value=Q.value,Q.value=null,c.platform.is.mobile===!0&&document.activeElement.blur()}function ge(n){Q.value=n}function pe(n){we(n,13)===!0&&X()}function x(n,d,A){const E={"aria-label":d,"aria-current":"false",...de.value,...n};return A===!0&&Object.assign(E,{"aria-current":"true",...ce.value}),d!==void 0&&(t.toFn!==void 0?E.to=t.toFn(d):E.onClick=()=>{W(d)}),B(b,E)}return Object.assign(u,{set:W,setByOffset:fe}),()=>{const n=[],d=[];let A;if(se.value===!0&&(n.push(x({key:"bls",disable:t.disable||t.modelValue<=r.value,icon:F.value[0],"aria-label":c.lang.pagination.first},r.value)),d.unshift(x({key:"ble",disable:t.disable||t.modelValue>=a.value,icon:F.value[3],"aria-label":c.lang.pagination.last},a.value))),ie.value===!0&&(n.push(x({key:"bdp",disable:t.disable||t.modelValue<=r.value,icon:F.value[1],"aria-label":c.lang.pagination.prev},t.modelValue-1)),d.unshift(x({key:"bdn",disable:t.disable||t.modelValue>=a.value,icon:F.value[2],"aria-label":c.lang.pagination.next},t.modelValue+1))),t.input!==!0){A=[];const{pgFrom:E,pgTo:Z,marginalStyle:D}=R.value;if(R.value.boundaryStart===!0){const _=r.value===t.modelValue;n.push(x({key:"bns",style:D,disable:t.disable,label:r.value},r.value,_))}if(R.value.boundaryEnd===!0){const _=a.value===t.modelValue;d.unshift(x({key:"bne",style:D,disable:t.disable,label:a.value},a.value,_))}R.value.ellipsesStart===!0&&n.push(x({key:"bes",style:D,disable:t.disable,label:"…",ripple:!1},E-1)),R.value.ellipsesEnd===!0&&d.unshift(x({key:"bee",style:D,disable:t.disable,label:"…",ripple:!1},Z+1));for(let _=E;_<=Z;_++)A.push(x({key:`bpg${_}`,style:D,disable:t.disable,label:_},_,_===t.modelValue))}return B("div",{class:re.value,...ue.value},[B("div",{class:"q-pagination__content row no-wrap items-center",style:ne.value},[...n,t.input===!0?B(h,{class:"inline",style:{width:`${J.value.length/1.5}em`},type:"number",dense:!0,value:Q.value,disable:t.disable,dark:o.value,borderless:!0,inputClass:t.inputClass,inputStyle:t.inputStyle,placeholder:J.value,min:r.value,max:a.value,"onUpdate:modelValue":ge,onKeyup:pe,onBlur:X}):B("div",{class:"q-pagination__middle row justify-center"},A),...d])])}}}),Ee={name:"VentasListado",data(){return{dialogCierre:!1,cierre:{date:M().format("YYYY-MM-DD"),monto_efectivo:0,monto_qr:0,observacion:""},dialogCaja:!1,caja:{name:"Inicio de Caja",total:0},loading:!1,rows:[],venta:{},dialogGasto:!1,meta:{current_page:1,last_page:1,total:0,from:0,to:0,per_page:20},pagination:{page:1,rowsPerPage:20,sortBy:"date",descending:!0},filters:{date_from:M().format("YYYY-MM-DD"),date_to:M().format("YYYY-MM-DD"),type:"",status:"",mesa:"",pago:"",user_id:"",q:""},summary:{total:0,count:0,by_type:[]},dlg:!1,current:null,detailCols:[{name:"name",label:"Producto",field:"name",align:"left"},{name:"qty",label:"Cant.",field:"qty",align:"right"},{name:"price",label:"Precio",field:"price",align:"right"},{name:"subtotal",label:"Subtotal",field:"subtotal",align:"right"}],users:[],dialogReporteUsuario:!1,selectedUserId:null,reporteUsuarioModo:"productos",reporteUsuarioFechaDesde:M().format("YYYY-MM-DD"),reporteUsuarioFechaHasta:M().format("YYYY-MM-DD")}},mounted(){this.fetchSales(),this.fetchUsers()},computed:{columns(){console.log("ROL USUARIO:",this.$store.user.role);const t=this.$store.user.role==="Administrador",e=[{name:"numero",label:"#",field:"numero",align:"left",sortable:!0},{name:"date",label:"Fecha",field:"date",align:"left",sortable:!0},{name:"time",label:"Hora",field:u=>String(u.time).substring(0,8),align:"left"},{name:"name",label:"Cliente",field:"name",align:"left"},{name:"mesa",label:"Mesa",field:"mesa",align:"left"}];return t&&e.push({name:"actions",label:"Opciones",field:"id",align:"right"},{name:"pago",label:"Pago",field:"pago",align:"left"},{name:"type",label:"Tipo",field:"type",align:"left"},{name:"status",label:"Estado",field:"status",align:"left"},{name:"total",label:"Total (Bs)",field:"total",align:"right",sortable:!0}),e},total(){const t=this.rows.filter(u=>u.type==="INGRESO"&&u.status==="ACTIVO"),e=this.rows.filter(u=>u.type==="EGRESO"&&u.status==="ACTIVO");return this.money(t.reduce((u,c)=>u+Number(c.total||0),0)-e.reduce((u,c)=>u+Number(c.total||0),0))},ingresoTotal(){let t=0;return this.rows.forEach(e=>{e.type==="INGRESO"&&e.status==="ACTIVO"&&(t+=Number(e.total||0))}),this.money(t)},ingresoEfectivo(){let t=0;return this.rows.forEach(e=>{e.type==="INGRESO"&&e.status==="ACTIVO"&&e.pago==="EFECTIVO"&&(t+=Number(e.total||0))}),this.money(t)},ingresoQr(){let t=0;return this.rows.forEach(e=>{e.type==="INGRESO"&&e.status==="ACTIVO"&&e.pago==="QR"&&(t+=Number(e.total||0))}),this.money(t)},countIngreso(){let t=0;return(this.rows||[]).forEach(e=>{e.type==="INGRESO"&&e.status==="ACTIVO"&&(t+=1)}),t},egresoCaja(){let t=0;return this.rows.forEach(e=>{e.type==="EGRESO"&&e.status==="ACTIVO"&&(t+=Number(e.total||0))}),this.money(t)}},methods:{async fetchUsers(){try{const{data:t}=await this.$axios.get("users");this.users=t}catch{this.$q.notify?.({type:"negative",message:"No se pudo cargar la lista de usuarios"})}},abrirReporteUsuario(t){this.reporteUsuarioModo=t,this.selectedUserId=null,this.reporteUsuarioFechaDesde=this.filters.date_from,this.reporteUsuarioFechaHasta=this.filters.date_to,this.dialogReporteUsuario=!0},async confirmarReporteUsuario(){if(!this.selectedUserId){this.$q.notify?.({type:"warning",message:"Seleccione un usuario"});return}this.loading=!0;try{const t={date_from:this.reporteUsuarioFechaDesde||this.filters.date_from,date_to:this.reporteUsuarioFechaHasta||this.filters.date_to,user_id:this.selectedUserId},{data:e}=await this.$axios.get("sales/report/by-user",{params:t});e.date_from=t.date_from,e.date_to=t.date_to,this.reporteUsuarioModo==="productos"?U.reporteProductosPorUsuario(e):U.reporteVentasPorUsuario(e),this.dialogReporteUsuario=!1}catch{this.$q.notify?.({type:"negative",message:"No se pudo generar el reporte"})}finally{this.loading=!1}},abrirCierreCaja(){const t=new Date().toISOString().slice(0,10);this.cierre={date:this.filters.date_from||t,monto_efectivo:0,monto_qr:0,observacion:""},this.dialogCierre=!0},async guardarCierreCaja(){if(this.cierre.monto_efectivo===null||this.cierre.monto_efectivo===""||isNaN(this.cierre.monto_efectivo)){this.$q.notify?.({type:"negative",message:"Ingrese el efectivo contado"});return}if(this.cierre.monto_qr===null||this.cierre.monto_qr===""||isNaN(this.cierre.monto_qr)){this.$q.notify?.({type:"negative",message:"Ingrese el monto QR contado (puede ser 0)"});return}this.loading=!0;try{const{data:t}=await this.$axios.post("cierres-caja",this.cierre);this.$q.notify?.({type:"positive",message:"Cierre de caja registrado"}),this.dialogCierre=!1,U.cierreCaja(t)}catch(t){this.$q.notify?.({type:"negative",message:t.response?.data?.message||"No se pudo guardar el cierre de caja"})}finally{this.loading=!1}},async printResumenUsuarios(){try{const t={...this.filters},{data:e}=await this.$axios.get("sales/report/by-user",{params:t});e.date_from=this.filters.date_from,e.date_to=this.filters.date_to,U.reporteUsuarios(e)}catch{this.$q.notify?.({type:"negative",message:"No se pudo generar el reporte de usuarios"})}},async printProductosUsuarios(){try{const t={...this.filters},{data:e}=await this.$axios.get("sales/report/by-user",{params:t});U.reporteProductosPorUsuario(e)}catch{this.$q.notify?.({type:"negative",message:"No se pudo generar el reporte de productos"})}},async printUltimoCierre(){try{const{data:t}=await this.$axios.get("cierres-caja-ultimo");U.cierreCaja(t)}catch{this.$q.notify?.({type:"negative",message:"No se encontró un cierre de caja"})}},anularVenta(t){this.$q.dialog({title:"Confirmar Anulación",message:`¿Está seguro de anular la venta #${t.numero}? Esta acción no se puede deshacer.`,cancel:!0,persistent:!0}).onOk(()=>{this.loading=!0,this.$axios.post(`sales/${t.id}/anular`).then(()=>{this.$q.notify?.({type:"positive",message:"Venta anulada"}),this.fetchSales()}).catch(()=>{this.$q.notify?.({type:"negative",message:"Error al anular venta"})}).finally(()=>{this.loading=!1})})},money(t){return Number(t||0).toLocaleString("es-BO",{minimumFractionDigits:2,maximumFractionDigits:2})},typeColor(t){return t==="INGRESO"?"green":t==="EGRESO"?"orange":t==="CAJA"?"blue":"grey"},resetFilters(){Object.assign(this.filters,{date_from:"",date_to:"",type:"",status:"",mesa:"",pago:"",user_id:"",q:""}),this.pagination.page=1,this.fetchSales()},pageChange(){this.pagination.page=this.meta.current_page,this.fetchSales()},onRequest(){},agregarGasto(){this.dialogGasto=!0},guardarGasto(){if(!this.venta.name||!this.venta.total){this.$q.notify?.({type:"negative",message:"Complete todos los campos"});return}this.loading=!0,this.$axios.post("sales",{name:this.venta.name,total:this.venta.total,type:"EGRESO",status:"ACTIVO",mesa:"GASTO",pago:"EFECTIVO",detalles:[],products:[]}).then(()=>{this.$q.notify?.({type:"positive",message:"Gasto agregado"}),this.dialogGasto=!1,this.venta={},this.fetchSales()}).catch(()=>{this.$q.notify?.({type:"negative",message:"Error al guardar gasto"})}).finally(()=>{this.loading=!1})},async verIngresosHoy(){try{const{data:t}=await this.$axios.get("cierres-caja/reporte/ultimo");U.reporteUltimoCierreUsuarios(t)}catch{this.$q.notify?.({type:"negative",message:"No hay cierres de caja registrados"})}},async fetchSales(){this.loading=!0;try{const t={page:this.pagination.page,per_page:this.pagination.rowsPerPage,...this.filters},{data:e}=await this.$axios.get("sales",{params:t});Array.isArray(e?.data)&&e?.meta?(this.rows=e.data,this.meta={current_page:e.meta.current_page,last_page:e.meta.last_page,total:e.meta.total,from:e.meta.from,to:e.meta.to,per_page:e.meta.per_page},this.summary=e.summary||this.summary):(this.rows=e.data||[],this.meta={current_page:e.current_page||1,last_page:e.last_page||1,total:e.total||0,from:e.from||0,to:e.to||0,per_page:e.per_page||this.pagination.rowsPerPage},this.summary={total:this.rows.reduce((u,c)=>u+Number(c.total||0),0),count:this.rows.length,by_type:[{type:"INGRESO",total:this.rows.filter(u=>u.type==="INGRESO").reduce((u,c)=>u+Number(c.total||0),0)},{type:"EGRESO",total:this.rows.filter(u=>u.type==="EGRESO").reduce((u,c)=>u+Number(c.total||0),0)},{type:"CAJA",total:this.rows.filter(u=>u.type==="CAJA").reduce((u,c)=>u+Number(c.total||0),0)}]})}catch{this.$q.notify?.({type:"negative",message:"No se pudo cargar ventas"})}finally{this.loading=!1}},openDetail(t){this.current=t,this.dlg=!0},async printTicket(t){try{const{data:e}=await this.$axios.get(`sales/${t.id}`);U.ticket(e)}catch{this.$q.notify?.({type:"negative",message:"No se pudo imprimir el ticket"})}}},watch:{"filters.type":"fetchSales","filters.status":"fetchSales","filters.mesa":"fetchSales","filters.pago":"fetchSales","filters.user_id":"fetchSales","filters.q":function(){this.pagination.page=1,this.fetchSales()},"filters.date_from":"fetchSales","filters.date_to":"fetchSales","pagination.rowsPerPage":"fetchSales"}},Ie={class:"row items-end q-col-gutter-sm"},Ne={class:"col-12 col-sm-2"},Pe={class:"col-12 col-sm-2"},Oe={class:"col-12 col-sm-2"},Re={class:"col-12 col-sm-2"},Ae={class:"col-12 col-sm-2"},De={class:"col-12 col-sm-2"},Be={class:"col-12 col-sm-4"},Te={class:"col-12 col-sm-8 text-right"},Me={key:0,class:"row q-col-gutter-sm q-mt-sm"},Qe={class:"col-12 col-sm-3"},Fe={class:"text-h6 text-bold"},Ge={class:"col-12 col-sm-3"},je={class:"text-h6 text-bold"},Ye={class:"col-12 col-sm-3"},Le={class:"text-h6 text-positive text-bold"},He={class:"text-caption"},ze={class:"text-caption"},Je={class:"col-12 col-sm-3"},Ke={class:"text-h6 text-bold text-red"},We={class:"row items-center q-pa-sm"},Xe={class:"col"},Ze={class:"text-caption text-grey-7"},$e={class:"col-auto"},et={class:"text-subtitle1"},tt={class:"row q-col-gutter-sm q-mb-sm"},lt={class:"col-6"},at={class:"col-3"},ot={class:"col-3"},st={class:"col-6"},it={class:"col-6"},rt={key:0,class:"col-12"},nt={class:"text-right q-mt-sm text-h6"},ut={class:"q-pa-sm"},dt={class:"q-pa-sm"},mt={class:"text-subtitle1"},ct={class:"row q-col-gutter-sm"},ft={class:"col-6"},gt={class:"col-6"},pt={class:"q-mt-md text-right"};function bt(t,e,u,c,o,r){return y(),C(ke,{class:"bg-grey-3 q-pa-sm"},{default:s(()=>[l(V,{flat:"",bordered:""},{default:s(()=>[l(v,{class:"q-pa-sm"},{default:s(()=>[i("div",Ie,[i("div",Ne,[l(h,{modelValue:o.filters.date_from,"onUpdate:modelValue":e[0]||(e[0]=a=>o.filters.date_from=a),type:"date",dense:"",outlined:"",label:"Desde"},null,8,["modelValue"])]),i("div",Pe,[l(h,{modelValue:o.filters.date_to,"onUpdate:modelValue":e[1]||(e[1]=a=>o.filters.date_to=a),type:"date",dense:"",outlined:"",label:"Hasta"},null,8,["modelValue"])]),i("div",Oe,[l(T,{modelValue:o.filters.type,"onUpdate:modelValue":e[2]||(e[2]=a=>o.filters.type=a),dense:"",outlined:"",label:"Tipo",options:["","INGRESO","EGRESO","CAJA"],"emit-value":"","map-options":""},null,8,["modelValue"])]),i("div",Re,[l(T,{modelValue:o.filters.status,"onUpdate:modelValue":e[3]||(e[3]=a=>o.filters.status=a),dense:"",outlined:"",label:"Estado",options:["","ACTIVO","ANULADO"],"emit-value":"","map-options":""},null,8,["modelValue"])]),i("div",Ae,[l(T,{modelValue:o.filters.mesa,"onUpdate:modelValue":e[4]||(e[4]=a=>o.filters.mesa=a),dense:"",outlined:"",label:"Mesa",options:["","MESA","LLEVAR","DELIVERY","PEDIDOS YA"],"emit-value":"","map-options":""},null,8,["modelValue"])]),i("div",De,[l(T,{modelValue:o.filters.user_id,"onUpdate:modelValue":e[5]||(e[5]=a=>o.filters.user_id=a),dense:"",outlined:"",clearable:"",label:"Usuario",options:o.users,"option-value":"id","option-label":"name","emit-value":"","map-options":""},null,8,["modelValue","options"])]),i("div",Be,[l(h,{modelValue:o.filters.q,"onUpdate:modelValue":e[6]||(e[6]=a=>o.filters.q=a),dense:"",outlined:"",debounce:"400",label:"Buscar (cliente, nro, comentario)"},null,8,["modelValue"])]),i("div",Te,[l(b,{color:"orange",icon:"lock",onClick:r.abrirCierreCaja,label:"Cierre de Caja","no-caps":"",class:"q-mr-sm"},null,8,["onClick"]),t.$store.user.role==="Administrador"?(y(),C(le,{key:0,color:"purple",icon:"print",label:"Reportes","no-caps":"",class:"q-mr-sm"},{default:s(()=>[l(te,null,{default:s(()=>[w((y(),C(S,{clickable:"",onClick:r.printResumenUsuarios},{default:s(()=>[l(p,{avatar:""},{default:s(()=>[l(q,{name:"groups"})]),_:1}),l(p,null,{default:s(()=>[...e[28]||(e[28]=[f("Ventas por usuario",-1)])]),_:1})]),_:1},8,["onClick"])),[[k]]),w((y(),C(S,{clickable:"",onClick:r.printProductosUsuarios},{default:s(()=>[l(p,{avatar:""},{default:s(()=>[l(q,{name:"restaurant"})]),_:1}),l(p,null,{default:s(()=>[...e[29]||(e[29]=[f("Productos por usuario",-1)])]),_:1})]),_:1},8,["onClick"])),[[k]]),w((y(),C(S,{clickable:"",onClick:r.printUltimoCierre},{default:s(()=>[l(p,{avatar:""},{default:s(()=>[l(q,{name:"lock"})]),_:1}),l(p,null,{default:s(()=>[...e[30]||(e[30]=[f("Último cierre de caja",-1)])]),_:1})]),_:1},8,["onClick"])),[[k]]),w((y(),C(S,{clickable:"",onClick:e[7]||(e[7]=a=>r.abrirReporteUsuario("productos"))},{default:s(()=>[l(p,{avatar:""},{default:s(()=>[l(q,{name:"person"})]),_:1}),l(p,null,{default:s(()=>[...e[31]||(e[31]=[f("Productos del usuario seleccionado",-1)])]),_:1})]),_:1})),[[k]]),w((y(),C(S,{clickable:"",onClick:e[8]||(e[8]=a=>r.abrirReporteUsuario("ventas"))},{default:s(()=>[l(p,{avatar:""},{default:s(()=>[l(q,{name:"receipt_long"})]),_:1}),l(p,null,{default:s(()=>[...e[32]||(e[32]=[f("Ventas del usuario seleccionado",-1)])]),_:1})]),_:1})),[[k]])]),_:1})]),_:1})):G("",!0),l(b,{color:"green",icon:"add_shopping_cart",to:{path:"/ventas"},label:"Crear Venta","no-caps":"",class:"q-mr-sm"}),l(b,{color:"blue",icon:"query_stats",label:"Ingresos del día","no-caps":"",class:"q-mr-sm",onClick:r.verIngresosHoy},null,8,["onClick"]),l(b,{flat:"",color:"primary",icon:"refresh",loading:o.loading,onClick:r.fetchSales,label:"Actualizar","no-caps":"",class:"q-mr-sm"},null,8,["loading","onClick"]),l(b,{outline:"",color:"primary",icon:"filter_alt_off",onClick:r.resetFilters,label:"Limpiar","no-caps":""},null,8,["onClick"])])])]),_:1})]),_:1}),e[53]||(e[53]=f(" bb ",-1)),t.$store.user.role==="Administrador"?(y(),ee("div",Me,[i("div",Qe,[l(V,{flat:"",bordered:""},{default:s(()=>[l(v,{class:"q-pa-sm"},{default:s(()=>[e[33]||(e[33]=i("div",{class:"text-caption text-grey"},"Total",-1)),i("div",Fe,m(r.total)+" Bs",1)]),_:1})]),_:1})]),i("div",Ge,[l(V,{flat:"",bordered:""},{default:s(()=>[l(v,{class:"q-pa-sm"},{default:s(()=>[e[34]||(e[34]=i("div",{class:"text-caption text-grey"},"# Ventas",-1)),i("div",je,m(r.countIngreso),1)]),_:1})]),_:1})]),i("div",Ye,[l(V,{flat:"",bordered:""},{default:s(()=>[l(v,{class:"q-pa-sm"},{default:s(()=>[e[39]||(e[39]=i("div",{class:"text-caption text-grey"},"Ingreso",-1)),i("div",Le,m(r.ingresoTotal)+" Bs",1),i("div",He,[e[35]||(e[35]=f(" Efectivo: ",-1)),i("b",null,m(r.ingresoEfectivo),1),e[36]||(e[36]=f(" Bs ",-1))]),i("div",ze,[e[37]||(e[37]=f(" QR: ",-1)),i("b",null,m(r.ingresoQr),1),e[38]||(e[38]=f(" Bs ",-1))])]),_:1})]),_:1})]),i("div",Je,[l(V,{flat:"",bordered:""},{default:s(()=>[l(v,{class:"q-pa-sm"},{default:s(()=>[e[40]||(e[40]=i("div",{class:"text-caption text-grey"},"Egreso/Caja",-1)),i("div",Ke,m(r.egresoCaja)+" Bs ",1)]),_:1})]),_:1})])])):G("",!0),l(V,{flat:"",bordered:"",class:"q-mt-sm"},{default:s(()=>[l(oe,{rows:o.rows,columns:r.columns,"row-key":"id",flat:"",bordered:"",dense:"",loading:o.loading,"rows-per-page-options":[10,20,50,0],pagination:o.pagination,onRequest:r.onRequest},{"body-cell-status":s(a=>[l(N,{props:a},{default:s(()=>[l(ae,{dense:"",color:a.row.status==="ACTIVO"?"green":"red","text-color":"white"},{default:s(()=>[f(m(a.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-type":s(a=>[l(N,{props:a},{default:s(()=>[l(ae,{dense:"",color:r.typeColor(a.row.type),"text-color":"white"},{default:s(()=>[f(m(a.row.type),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-total":s(a=>[l(N,{props:a,class:"text-right"},{default:s(()=>[f(m(r.money(a.row.total)),1)]),_:2},1032,["props"])]),"body-cell-actions":s(a=>[l(N,{props:a},{default:s(()=>[l(le,{dense:"",label:"Opciones","no-caps":"",size:"xs",color:"primary"},{default:s(()=>[l(te,null,{default:s(()=>[w((y(),C(S,{clickable:"",onClick:P=>r.openDetail(a.row)},{default:s(()=>[l(p,{avatar:""},{default:s(()=>[l(q,{name:"visibility"})]),_:1}),l(p,null,{default:s(()=>[...e[41]||(e[41]=[f("Ver Detalle",-1)])]),_:1})]),_:1},8,["onClick"])),[[k]]),w((y(),C(S,{clickable:"",onClick:P=>r.printTicket(a.row)},{default:s(()=>[l(p,{avatar:""},{default:s(()=>[l(q,{name:"print"})]),_:1}),l(p,null,{default:s(()=>[...e[42]||(e[42]=[f("Imprimir ticket",-1)])]),_:1})]),_:1},8,["onClick"])),[[k]]),a.row.status==="ACTIVO"?w((y(),C(S,{key:0,clickable:"",onClick:P=>r.anularVenta(a.row)},{default:s(()=>[l(p,{avatar:""},{default:s(()=>[l(q,{name:"cancel"})]),_:1}),l(p,null,{default:s(()=>[...e[43]||(e[43]=[f("Anular Venta",-1)])]),_:1})]),_:1},8,["onClick"])),[[k]]):G("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),"no-data":s(()=>[...e[44]||(e[44]=[i("div",{class:"full-width row flex-center q-pa-lg text-grey"}," Sin resultados ",-1)])]),_:1},8,["rows","columns","loading","pagination","onRequest"]),i("div",We,[i("div",Xe,[i("span",Ze," Mostrando "+m(o.meta.from||0)+"–"+m(o.meta.to||0)+" de "+m(o.meta.total||0),1)]),i("div",$e,[l(Ue,{modelValue:o.meta.current_page,"onUpdate:modelValue":[e[9]||(e[9]=a=>o.meta.current_page=a),r.pageChange],max:o.meta.last_page||1,"max-pages":"8","direction-links":"","boundary-links":""},null,8,["modelValue","max","onUpdate:modelValue"])])])]),_:1}),l(j,{modelValue:o.dlg,"onUpdate:modelValue":e[11]||(e[11]=a=>o.dlg=a),persistent:""},{default:s(()=>[l(V,{style:{width:"800px","max-width":"95vw"}},{default:s(()=>[l(v,{class:"row items-center q-pb-none"},{default:s(()=>[i("div",et," Venta #"+m(o.current?.numero)+" — "+m(o.current?.date)+" "+m(o.current?.time?.substring(0,8)),1),l(Y),l(b,{flat:"",round:"",dense:"",icon:"close",onClick:e[10]||(e[10]=a=>o.dlg=!1)})]),_:1}),l(v,{class:"q-pt-none"},{default:s(()=>[i("div",tt,[i("div",lt,[e[45]||(e[45]=i("b",null,"Cliente:",-1)),f(" "+m(o.current?.name),1)]),i("div",at,[e[46]||(e[46]=i("b",null,"Mesa:",-1)),f(" "+m(o.current?.mesa),1)]),i("div",ot,[e[47]||(e[47]=i("b",null,"Pago:",-1)),f(" "+m(o.current?.pago),1)]),i("div",st,[e[48]||(e[48]=i("b",null,"Tipo:",-1)),f(" "+m(o.current?.type),1)]),i("div",it,[e[49]||(e[49]=i("b",null,"Estado:",-1)),f(" "+m(o.current?.status),1)]),o.current?.comment?(y(),ee("div",rt,[e[50]||(e[50]=i("b",null,"Comentario:",-1)),f(" "+m(o.current?.comment),1)])):G("",!0)]),l(oe,{rows:o.current?.detalles||[],columns:o.detailCols,flat:"",bordered:"",dense:"","row-key":"id"},{"body-cell-subtotal":s(a=>[l(N,{props:a,class:"text-right"},{default:s(()=>[f(m(r.money(a.row.subtotal)),1)]),_:2},1032,["props"])]),"body-cell-price":s(a=>[l(N,{props:a,class:"text-right"},{default:s(()=>[f(m(r.money(a.row.price)),1)]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),i("div",nt," Total: "+m(r.money(o.current?.total||0))+" Bs ",1)]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:o.dialogGasto,"onUpdate:modelValue":e[15]||(e[15]=a=>o.dialogGasto=a),persistent:""},{default:s(()=>[l(V,{style:{width:"400px","max-width":"95vw"}},{default:s(()=>[l(v,{class:"row items-center q-pb-none"},{default:s(()=>[e[51]||(e[51]=i("div",{class:"text-subtitle1"}," Agregar Gasto ",-1)),l(Y),l(b,{flat:"",round:"",dense:"",icon:"close",onClick:e[12]||(e[12]=a=>o.dialogGasto=!1)})]),_:1}),l(v,null,{default:s(()=>[i("div",ut,[l(h,{modelValue:o.venta.name,"onUpdate:modelValue":e[13]||(e[13]=a=>o.venta.name=a),label:"Descripción",outlined:"",dense:"",class:"q-mb-sm"},null,8,["modelValue"]),l(h,{modelValue:o.venta.total,"onUpdate:modelValue":e[14]||(e[14]=a=>o.venta.total=a),modelModifiers:{number:!0},label:"Monto (Bs)",type:"number",outlined:"",dense:"",class:"q-mb-sm"},null,8,["modelValue"]),l(b,{label:"Guardar",color:"primary",onClick:r.guardarGasto,loading:o.loading},null,8,["onClick","loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:o.dialogCierre,"onUpdate:modelValue":e[21]||(e[21]=a=>o.dialogCierre=a),persistent:""},{default:s(()=>[l(V,{style:{width:"420px","max-width":"95vw"}},{default:s(()=>[l(v,{class:"row items-center q-pb-none"},{default:s(()=>[e[52]||(e[52]=i("div",{class:"text-subtitle1"}," Cierre de Caja ",-1)),l(Y),l(b,{flat:"",round:"",dense:"",icon:"close",onClick:e[16]||(e[16]=a=>o.dialogCierre=!1)})]),_:1}),l(v,null,{default:s(()=>[i("div",dt,[l(h,{modelValue:o.cierre.date,"onUpdate:modelValue":e[17]||(e[17]=a=>o.cierre.date=a),type:"date",label:"Fecha",outlined:"",dense:"",class:"q-mb-sm"},null,8,["modelValue"]),l(h,{modelValue:o.cierre.monto_efectivo,"onUpdate:modelValue":e[18]||(e[18]=a=>o.cierre.monto_efectivo=a),modelModifiers:{number:!0},type:"number",label:"Efectivo contado (Bs)",outlined:"",dense:"",class:"q-mb-sm"},null,8,["modelValue"]),l(h,{modelValue:o.cierre.monto_qr,"onUpdate:modelValue":e[19]||(e[19]=a=>o.cierre.monto_qr=a),modelModifiers:{number:!0},type:"number",label:"Monto QR contado (Bs)",outlined:"",dense:"",class:"q-mb-sm"},null,8,["modelValue"]),l(h,{modelValue:o.cierre.observacion,"onUpdate:modelValue":e[20]||(e[20]=a=>o.cierre.observacion=a),type:"textarea",label:"Observación",outlined:"",dense:"",class:"q-mb-sm"},null,8,["modelValue"]),l(b,{label:"Guardar y imprimir",color:"primary",onClick:r.guardarCierreCaja,loading:o.loading},null,8,["onClick","loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(j,{modelValue:o.dialogReporteUsuario,"onUpdate:modelValue":e[27]||(e[27]=a=>o.dialogReporteUsuario=a),persistent:""},{default:s(()=>[l(V,{style:{width:"400px","max-width":"95vw"}},{default:s(()=>[l(v,{class:"row items-center q-pb-none"},{default:s(()=>[i("div",mt,m(o.reporteUsuarioModo==="productos"?"Reporte de productos por usuario":"Reporte de ventas por usuario"),1),l(Y),l(b,{flat:"",round:"",dense:"",icon:"close",onClick:e[22]||(e[22]=a=>o.dialogReporteUsuario=!1)})]),_:1}),l(v,null,{default:s(()=>[l(T,{modelValue:o.selectedUserId,"onUpdate:modelValue":e[23]||(e[23]=a=>o.selectedUserId=a),options:o.users,"option-value":"id","option-label":"name","emit-value":"","map-options":"",dense:"",outlined:"",label:"Usuario",class:"q-mb-sm"},null,8,["modelValue","options"]),i("div",ct,[i("div",ft,[l(h,{modelValue:o.reporteUsuarioFechaDesde,"onUpdate:modelValue":e[24]||(e[24]=a=>o.reporteUsuarioFechaDesde=a),type:"date",dense:"",outlined:"",label:"Desde"},null,8,["modelValue"])]),i("div",gt,[l(h,{modelValue:o.reporteUsuarioFechaHasta,"onUpdate:modelValue":e[25]||(e[25]=a=>o.reporteUsuarioFechaHasta=a),type:"date",dense:"",outlined:"",label:"Hasta"},null,8,["modelValue"])])]),i("div",pt,[l(b,{flat:"",label:"Cancelar",color:"primary",class:"q-mr-sm",onClick:e[26]||(e[26]=a=>o.dialogReporteUsuario=!1)}),l(b,{label:"Imprimir",color:"primary",loading:o.loading,onClick:r.confirmarReporteUsuario},null,8,["loading","onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e[54]||(e[54]=i("div",{id:"myelement",class:"hidden"},null,-1))]),_:1})}const It=qe(Ee,[["render",bt],["__scopeId","data-v-0af947b0"]]);export{It as default};
